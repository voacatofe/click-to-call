;============================ TRANSPORTE DUAL (WS + WSS) ============================
[transport-ws]
type=transport
protocol=ws
bind=0.0.0.0:8088
external_media_address=localhost
external_signaling_address=localhost

[transport-wss]
type=transport
protocol=wss
bind=0.0.0.0:8089
; Certificados para WSS
cert_file=/etc/asterisk/keys/asterisk.crt
priv_key_file=/etc/asterisk/keys/asterisk.key
external_media_address=localhost
external_signaling_address=localhost

;============================ ENDPOINT UNIFICADO ============================
; AOR compartilhado para ambos os transportes
[agent-1001]
type=aor
max_contacts=10  ; Permitir múltiplas conexões (WS + WSS)
remove_existing=yes

; Auth compartilhado
[agent-1001]
type=auth
auth_type=userpass
username=agent-1001
password=changeme

; Endpoint para WS (desenvolvimento)
[agent-1001-ws]
type=endpoint
aors=agent-1001
auth=agent-1001
transport=transport-ws
context=from-internal
; Configuração simplificada para WS
disallow=all
allow=ulaw,alaw,gsm
rtp_symmetric=yes
force_rport=yes
direct_media=no
use_avpf=no
media_encryption=no
ice_support=yes
media_use_received_transport=yes
rtcp_mux=no

; Endpoint para WSS (produção)
[agent-1001-wss]
type=endpoint
aors=agent-1001
auth=agent-1001
transport=transport-wss
context=from-internal
; Configuração completa WebRTC com DTLS
webrtc=yes
use_avpf=yes
media_encryption=dtls
dtls_verify=fingerprint
dtls_setup=actpass
dtls_auto_generate_cert=yes
ice_support=yes
media_use_received_transport=yes
rtcp_mux=yes
disallow=all
allow=opus,ulaw,alaw
rtp_symmetric=yes
force_rport=yes
direct_media=no
timers=yes
timers_min_se=90
timers_sess_expires=1800 
[transport-ws]
type=transport
protocol=ws
bind=0.0.0.0:8088
external_media_address=localhost
external_signaling_address=localhost

[transport-wss]
type=transport
protocol=wss
bind=0.0.0.0:8089
; Certificados para WSS
cert_file=/etc/asterisk/keys/asterisk.crt
priv_key_file=/etc/asterisk/keys/asterisk.key
external_media_address=localhost
external_signaling_address=localhost

;============================ ENDPOINT UNIFICADO ============================
; AOR compartilhado para ambos os transportes
[agent-1001]
type=aor
max_contacts=10  ; Permitir múltiplas conexões (WS + WSS)
remove_existing=yes

; Auth compartilhado
[agent-1001]
type=auth
auth_type=userpass
username=agent-1001
password=changeme

; Endpoint para WS (desenvolvimento)
[agent-1001-ws]
type=endpoint
aors=agent-1001
auth=agent-1001
transport=transport-ws
context=from-internal
; Configuração simplificada para WS
disallow=all
allow=ulaw,alaw,gsm
rtp_symmetric=yes
force_rport=yes
direct_media=no
use_avpf=no
media_encryption=no
ice_support=yes
media_use_received_transport=yes
rtcp_mux=no

; Endpoint para WSS (produção)
[agent-1001-wss]
type=endpoint
aors=agent-1001
auth=agent-1001
transport=transport-wss
context=from-internal
; Configuração completa WebRTC com DTLS
webrtc=yes
use_avpf=yes
media_encryption=dtls
dtls_verify=fingerprint
dtls_setup=actpass
dtls_auto_generate_cert=yes
ice_support=yes
media_use_received_transport=yes
rtcp_mux=yes
disallow=all
allow=opus,ulaw,alaw
rtp_symmetric=yes
force_rport=yes
direct_media=no
timers=yes
timers_min_se=90
timers_sess_expires=1800 