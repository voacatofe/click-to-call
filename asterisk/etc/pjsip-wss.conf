;============================ TRANSPORTE WSS ============================
[transport-wss]
type=transport
protocol=wss
bind=127.0.0.1:8089
; Certificados para WSS (serão montados via volume Docker)
cert_file=/etc/asterisk/keys/asterisk.crt
priv_key_file=/etc/asterisk/keys/asterisk.key
; Configurações para produção
external_media_address=localhost  ; Substituir pelo IP/domínio real em produção
external_signaling_address=localhost

;============================ ENDPOINT WSS ============================
[agent-1001-wss]
type=aor
max_contacts=5
remove_existing=yes

[agent-1001-wss]
type=auth
auth_type=userpass
username=agent-1001
password=${AGENT_1001_PASSWORD:-changeme_update_this}
; ATENÇÃO: Configurar AGENT_1001_PASSWORD no environment

[agent-1001-wss]
type=endpoint
aors=agent-1001-wss
auth=agent-1001-wss
transport=transport-wss
context=from-internal
; Configuração completa WebRTC com DTLS para WSS
webrtc=yes
use_avpf=yes
media_encryption=dtls
dtls_verify=fingerprint
dtls_setup=actpass
dtls_auto_generate_cert=yes
ice_support=yes
media_use_received_transport=yes
rtcp_mux=yes
; Codecs otimizados para WebRTC
disallow=all
allow=opus,ulaw,alaw
; Configurações RTP para WebRTC
rtp_symmetric=yes
force_rport=yes
direct_media=no
; Configurações adicionais para estabilidade
timers=yes
timers_min_se=90
timers_sess_expires=1800 